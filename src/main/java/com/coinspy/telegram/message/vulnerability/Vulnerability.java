package com.coinspy.telegram.message.vulnerability;

public class Vulnerability {

    //todo v0.8.3-nightly.2021.3.17+commit.e179d0aa
    //example value: "v0.6.7+commit.b8d736ae"

    public static int possibleVulnerability(String compilerVersion){
        String[] version = cutVersion(compilerVersion).split("\\."); //[0] = v0, [1] = 6, [2] = 7
        int v1 = Integer.parseInt(version[1]);
        int v2 = Integer.parseInt(version[2]);

        if (v1==8) {
            if (v2>3) return 0;
            if (v2==3) return 1;
            return 2;
        }
        if (v1==7) return 2;
        if (v1==6){
            if (v2>=10) return 4;
            if (v2==9) return 5;
            if (v2>=7) return 7;
            if (v2>=2) return 8;
            if (v2>0) return 9;
            if (v2==0) return 10;
        }
        if (v1==5){
            if (v2<=17) return 8;
            return 9;
        }
        if (v1==4){
            if (v2<=26) return 11;
            return 16;
        }
        return 0;
    }

    public static String cutVersion(String compilerVersion){
        int i = compilerVersion.indexOf('+');
        compilerVersion.substring(0, i);
        return compilerVersion.substring(0, i);
    }
}




//0.4.23 - 16
//0.4.24 - 16
//0.4.26 - 11
//0.4.26 - 11
//0.5.16 - 9
//0.5.17 - 8

//0.6.0 - 10
//0.6.2 - 9
//0.6.5 - 8
//0.6.7 - 7
//0.6.9 - 5
//0.6.10 - 4
//0.6.11 - 4
//0.6.12 - 4
//0.7.4 - 2
//0.7.6 - 2
//0.8.0 - 2
//0.8.2 - 2
//0.8.3 - 1
//0.8.4 - 0
//0.8.5 - 0
//0.8.6 - 0